---
milestone: v1.0
audited: 2026-02-26T18:30:00Z
status: gaps_found
scores:
  requirements: 14/27
  phases: 3/5
  integration: 15/18
  flows: 3/6
gaps:
  requirements:
    - id: "AI-05"
      status: "unsatisfied"
      phase: "Phase 3"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "Phase 3 directory does not exist — not planned or executed."
    - id: "FE-03"
      status: "unsatisfied"
      phase: "Phase 3"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "/app/history page does not exist. captureGraphHistoryViewed() stub has no callers."
    - id: "AUTH-01"
      status: "unsatisfied"
      phase: "Phase 3"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "No Clerk sign-up/sign-in pages. No /app/* auth middleware. DEV_SKIP_AUTH=true bypasses JWT in dev."
    - id: "AUTH-02"
      status: "unsatisfied"
      phase: "Phase 3"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "HeroSection.tsx sends no Authorization header — landing page trial returns 401 in production. No sign-up prompt modal on second attempt."
    - id: "AUTH-03"
      status: "unsatisfied"
      phase: "Phase 3"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "No Supabase users or graphs tables. No Clerk webhook sync."
    - id: "AUTH-04"
      status: "unsatisfied"
      phase: "Phase 3"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "No Supabase request_log table. No request logging middleware."
    - id: "AI-02 (Redis caching)"
      status: "unsatisfied"
      phase: "Phase 4"
      claimed_by_plans: []
      completed_by_plans: ["01-03-PLAN.md (scraping/extraction sub-req satisfied)"]
      verification_status: "missing"
      evidence: "Scraping/extraction sub-req satisfied in Phase 1. Redis caching sub-req explicitly deferred to Phase 4. Phase 4 not started."
    - id: "RATE-01"
      status: "unsatisfied"
      phase: "Phase 4"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "Phase 4 not started. No rate limiting implementation."
    - id: "RATE-02"
      status: "unsatisfied"
      phase: "Phase 4"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "Phase 4 not started. No Vercel Edge middleware."
    - id: "RATE-03"
      status: "unsatisfied"
      phase: "Phase 4"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "Phase 4 not started. Redis URL caching not implemented."
    - id: "EXP-01"
      status: "unsatisfied"
      phase: "Phase 4"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "Phase 4 not started. captureGraphExported() stub exists but no export UI."
    - id: "EXP-02"
      status: "unsatisfied"
      phase: "Phase 4"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "Phase 4 not started. No PNG export or Vercel Blob integration."
    - id: "OBS-02 (landing page)"
      status: "partial"
      phase: "Phase 5"
      claimed_by_plans: ["05-02-PLAN.md", "05-05-PLAN.md"]
      completed_by_plans: ["05-02-SUMMARY.md"]
      verification_status: "partial"
      evidence: "captureGraphGenerated() wired in app/app/page.tsx but NOT called in HeroSection.tsx success branch. Landing page graph generations — primary acquisition funnel — produce no PostHog event."
  integration:
    - from: "HeroSection.tsx"
      to: "POST /api/generate"
      issue: "No Authorization header. Works only with DEV_SKIP_AUTH=true. Will 401 in production. Affects SEC-03, AUTH-02."
    - from: "HeroSection.tsx"
      to: "apps/web/lib/api.ts"
      issue: "HeroSection inlines fetch() instead of using generateGraph(). Phase 2 error handling (isScrapeFailure, FE-05 toasts, AbortController) absent from landing page. Affects FE-04, FE-05."
    - from: "HeroSection.tsx"
      to: "apps/web/lib/analytics.ts"
      issue: "captureGraphGenerated() not called in success branch. Landing page conversions untracked. Affects OBS-02."
  flows:
    - flow: "Landing page anonymous trial — production"
      breaks_at: "Backend auth gate — HeroSection sends no Authorization header"
      affects: ["AUTH-02", "SEC-03"]
    - flow: "Landing page scrape-error UX"
      breaks_at: "isScrapeFailure check missing — shows inline text not FE-05 toast string"
      affects: ["FE-05"]
    - flow: "Landing page graph generation — analytics"
      breaks_at: "captureGraphGenerated() not called in HeroSection success branch"
      affects: ["OBS-02"]
tech_debt:
  - phase: "05-landing-page-observability"
    items:
      - "HeroSection.tsx duplicates POST /api/generate fetch inline — should use lib/api.ts:generateGraph(). Dual maintenance risk when Phase 3 adds auth headers."
      - "captureGraphExported() stub in analytics.ts has no callers — waiting on Phase 4 export buttons."
      - "captureGraphHistoryViewed() stub in analytics.ts has no callers — waiting on Phase 3 history page."
  - phase: "01-backend-foundation"
    items:
      - "DEV_SKIP_AUTH=true in apps/api/.env but not in .env.example — risk of accidental production bypass."
---

# Milestone Audit: GraphVC v1.0

**Audited:** 2026-02-26
**Status:** gaps_found
**Phases Complete:** 3/5 (Phase 1, 2, 5)
**Phases Pending:** 2/5 (Phase 3: Auth + Persistence, Phase 4: Guardrails + Export)

---

## Executive Summary

Three of five planned phases are complete and fully verified. The executed phases deliver a working product: a FastAPI pipeline extracting VC relationship graphs from text/URLs, a Cytoscape.js frontend at `/app`, a public landing page at `/`, and Sentry + PostHog observability. All 14 requirements in scope for phases 1, 2, and 5 are satisfied.

**13 requirements remain unsatisfied** — all mapped to Phases 3 (Auth + Persistence) and 4 (Guardrails + Export), which have not yet been planned or executed. Three integration issues were also found in the Phase 5 landing page hero section (analytics gap, error UX gap, production auth gap) — these will be resolved during Phase 3 implementation.

The milestone is on-track but not complete. Continue to Phase 3 planning.

---

## Requirements Coverage (14/27 satisfied)

### Satisfied (14)

| Requirement | Phase | Description | Status |
|-------------|-------|-------------|--------|
| INFRA-01 | 1 | Monorepo scaffold — apps/api (FastAPI), apps/web (Next.js 15), packages/shared-types | ✓ |
| INFRA-02 | 1 | docker-compose starts Neo4j + Redis; services connect via .env.local | ✓ |
| INFRA-03 | 2 | CI/CD: typecheck/lint/test on PR; Vercel preview on PR; Railway deploy on main | ✓ |
| SEC-01 | 1 | SSRF URL validation (RFC 1918, loopback, link-local, IPv6) | ✓ |
| SEC-02 | 1 | All Neo4j queries parameterized — zero string interpolation | ✓ |
| SEC-03 | 1 | Clerk JWT validation on /api/generate | ✓ (dev bypass only — see integration gaps) |
| SEC-04 | 1 | Single Neo4j driver singleton via app.state | ✓ |
| SEC-05 | 5 | Security headers on all Next.js responses | ✓ (REQUIREMENTS.md checkbox needs update) |
| AI-01 | 1 | GPT-4o extraction with VC-specific prompt — 5 entity types, 8 relationship types | ✓ |
| AI-02/scraping | 1 | URL scraping with BeautifulSoup, 32k char cap, SSRF-safe | ✓ |
| AI-03 | 1 | Raw text path bypasses scraping | ✓ |
| AI-04 | 1 | 200-char minimum validation with exact error message | ✓ |
| FE-01 | 2 | Cytoscape canvas with 5 VC entity styles (locked colors + shapes) | ✓ |
| FE-02 | 2 | Node click → detail panel; background click → close | ✓ |
| FE-04 | 5 | Landing page at / with hero, HowItWorks, PersonaCards, footer | ✓ |
| FE-05 | 2 | Error toasts (exact strings), animated progress, cancel/abort | ✓ (absent from HeroSection — see integration) |
| OBS-01 | 5 | Sentry on Next.js + FastAPI, exceptions captured with user context | ✓ |

### Partial (1)

| Requirement | Phase | Missing |
|-------------|-------|---------|
| OBS-02 | 5 | `captureGraphGenerated()` not called in `HeroSection.tsx`. Landing page graph generations produce no PostHog event. |

### Unsatisfied — Phases Not Started (12)

| Requirement | Phase | Note |
|-------------|-------|------|
| AI-05 | 3 | Graph persistence with user ownership |
| FE-03 | 3 | /app/history page |
| AUTH-01 | 3 | Clerk sign-up/sign-in, /app/* auth middleware |
| AUTH-02 | 3 | Anonymous 1 graph/day + sign-up prompt — also blocks landing trial in production |
| AUTH-03 | 3 | Supabase users + graphs tables, Clerk webhook |
| AUTH-04 | 3 | Request logging to Supabase |
| AI-02 (Redis caching) | 4 | 1-hour Redis cache for scraped URLs (scraping sub-req done in Phase 1) |
| RATE-01 | 4 | Per-user rate limiting via Upstash Redis sliding window |
| RATE-02 | 4 | Vercel Edge 60 req/min per IP |
| RATE-03 | 4 | Redis URL content caching |
| EXP-01 | 4 | JSON export |
| EXP-02 | 4 | PNG export via Vercel Blob |

---

## Phase Status

| Phase | Plans | Status | Requirements Covered |
|-------|-------|--------|---------------------|
| 1. Backend Foundation | 5/5 | ✓ Complete | INFRA-01, INFRA-02, SEC-01–04, AI-01–04 |
| 2. Monorepo + Vertical Slice | 6/6 | ✓ Complete | INFRA-03, FE-01, FE-02, FE-05 |
| 3. Auth + Persistence | 0/TBD | ○ Not started | AI-05, FE-03, AUTH-01–04 |
| 4. Guardrails + Export | 0/TBD | ○ Not started | AI-02/caching, RATE-01–03, EXP-01–02 |
| 5. Landing Page + Observability | 6/6 | ✓ Complete | SEC-05, FE-04, OBS-01, OBS-02 |

---

## Cross-Phase Integration

### Verified Connections (15)

| From | To | Status |
|------|----|--------|
| packages/shared-types | GraphCanvas.tsx, DetailPanel.tsx, HeroSection.tsx, app/app/page.tsx | ✓ |
| apps/web/lib/api.ts:generateGraph() | apps/web/app/app/page.tsx | ✓ |
| apps/web/lib/analytics.ts:captureGraphGenerated() | apps/web/app/app/page.tsx | ✓ |
| cytoscapeStyles.ts | GraphCanvas.tsx, DemoGraphCanvas.tsx | ✓ |
| apps/api/app/auth/clerk.py | router.py via dependencies.py | ✓ |
| apps/api/app/graph/repository.py:persist_graph() | service.py | ✓ |
| apps/api/app/scraper/ssrf.py | scraper.py, service.py | ✓ |
| apps/api/app/scraper/scraper.py:scrape_url() | service.py | ✓ |

### Integration Gaps (3)

| Issue | Severity | Affected REQs | Planned Fix |
|-------|----------|--------------|-------------|
| HeroSection sends no auth header — 401 in production | Production-blocking | AUTH-02, SEC-03 | Phase 3: AUTH-02 anonymous session strategy |
| HeroSection inline fetch bypasses lib/api.ts error handling — FE-05 toast absent | High | FE-04, FE-05 | Phase 3: refactor HeroSection to use generateGraph() |
| captureGraphGenerated() not called in HeroSection success branch | High | OBS-02 | Low-effort: add one call to handleTry() success branch |

---

## E2E Flows

### Complete (3)

| Flow | Path |
|------|------|
| Authenticated /app graph generate (dev) | InputCard → generateGraph() → /api/generate (DEV_SKIP_AUTH) → VCGraph → GraphCanvas → captureGraphGenerated() |
| Node click → detail panel → navigate | cy.on('tap', node) → onNodeClick() → DetailPanel → onNavigate() |
| Cancel in-flight request | AbortController → fetch abort → LoadingSteps hide |

### Broken / Incomplete (3)

| Flow | Breaks At | Severity |
|------|-----------|----------|
| Landing page anonymous trial (production) | Backend 401 — no auth header | Production-blocking |
| Landing page graph generation → analytics | captureGraphGenerated() not called | High |
| Landing page scrape-error UX | isScrapeFailure absent → wrong error display | Medium |

---

## Tech Debt (5 items across 2 phases)

**Phase 01 — Backend Foundation**
- `DEV_SKIP_AUTH=true` in `apps/api/.env` not documented in `.env.example` — risk of accidental production bypass

**Phase 05 — Landing Page + Observability**
- `HeroSection.tsx` duplicates `fetch('/api/generate')` inline instead of using `lib/api.ts:generateGraph()` — dual maintenance required when Phase 3 adds auth headers
- `captureGraphExported()` stub — no caller until Phase 4 export buttons built
- `captureGraphHistoryViewed()` stub — no caller until Phase 3 history page built
- REQUIREMENTS.md checkbox `- [ ] SEC-05` should be `- [x]` — implementation is correct but documentation lags

---

## Orphan Check

No true orphans found. All unverified requirements (12) are mapped to unexecuted phases (3 and 4) — their absence is expected and planned.

---
*Audit created: 2026-02-26*
*Auditor: Claude (gsd-verifier + gsd-integration-checker)*
*Scope: v1.0 milestone — GraphVC anonymous graph extraction MVP*
