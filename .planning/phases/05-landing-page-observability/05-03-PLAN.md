---
phase: 05-landing-page-observability
plan: "03"
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/components/landing/DemoGraph.tsx
  - apps/web/components/landing/DemoGraphCanvas.tsx
  - apps/web/components/landing/LandingNav.tsx
  - apps/web/components/landing/HeroSection.tsx
autonomous: true
requirements:
  - FE-04

must_haves:
  truths:
    - "The demo graph renders an animated, interactive Cytoscape canvas using the same entity styling as the app (indigo investor ellipses, emerald project rectangles, amber round diamonds, violet narrative hexagons, pink person ellipses)"
    - "The demo graph animates in on load via fcose layout with animationDuration: 800"
    - "The nav shows logo (Instagraph) on the left and a Sign In / Go to app button on the right"
    - "The hero section has a split layout: input card on left, demo graph on right above the fold"
  artifacts:
    - path: "apps/web/components/landing/DemoGraph.tsx"
      provides: "Dynamic import wrapper for DemoGraphCanvas (ssr:false) + DEMO_GRAPH_DATA constant"
      contains: "DEMO_GRAPH_DATA"
    - path: "apps/web/components/landing/DemoGraphCanvas.tsx"
      provides: "Cytoscape canvas with hardcoded fictional VC data, fcose animate, cytoscapeStylesheet reuse"
      contains: "CytoscapeComponent"
    - path: "apps/web/components/landing/LandingNav.tsx"
      provides: "Sticky nav bar: Instagraph logo left, auth-aware Sign In / Go to app right"
      contains: "LandingNav"
    - path: "apps/web/components/landing/HeroSection.tsx"
      provides: "Split hero layout: left input area + right DemoGraph canvas, outcome-led headline"
      contains: "HeroSection"
  key_links:
    - from: "apps/web/components/landing/DemoGraph.tsx"
      to: "apps/web/components/landing/DemoGraphCanvas.tsx"
      via: "dynamic(() => import('./DemoGraphCanvas'), { ssr: false })"
      pattern: "ssr.*false"
    - from: "apps/web/components/landing/DemoGraphCanvas.tsx"
      to: "apps/web/components/graph/cytoscapeStyles.ts"
      via: "import { cytoscapeStylesheet } from '@/components/graph/cytoscapeStyles'"
      pattern: "cytoscapeStylesheet"
---

<objective>
Build the landing page foundation components: DemoGraph canvas and the hero section.

Purpose: The demo graph and hero section are the highest-value, highest-complexity landing page components. Building them first in their own plan avoids context overrun. The DemoGraph reuses the existing Cytoscape stack (already installed) with identical entity styling.

Output: DemoGraph.tsx (dynamic wrapper) + DemoGraphCanvas.tsx (canvas with fcose animate) + LandingNav.tsx + HeroSection.tsx.
</objective>

<execution_context>
@/Users/uzi/.claude/get-shit-done/workflows/execute-plan.md
@/Users/uzi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/05-landing-page-observability/05-CONTEXT.md
@.planning/phases/05-landing-page-observability/05-RESEARCH.md
@apps/web/components/graph/cytoscapeStyles.ts
@apps/web/components/graph/GraphCanvas.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: DemoGraph canvas components</name>
  <files>
    apps/web/components/landing/DemoGraph.tsx
    apps/web/components/landing/DemoGraphCanvas.tsx
  </files>
  <action>
Create `apps/web/components/landing/` directory.

**Create `apps/web/components/landing/DemoGraph.tsx`** (outer wrapper with dynamic import):
```typescript
'use client'

import dynamic from 'next/dynamic'

// CRITICAL: ssr:false required — react-cytoscapejs accesses window at module import
// Same pattern as app/app/page.tsx GraphCanvas dynamic import
const DemoGraphCanvas = dynamic(() => import('./DemoGraphCanvas'), {
  ssr: false,
  loading: () => (
    <div className="w-full h-full bg-gray-900 animate-pulse rounded-lg flex items-center justify-center">
      <span className="text-gray-600 text-sm">Loading graph...</span>
    </div>
  ),
})

export const DEMO_GRAPH_DATA = {
  nodes: [
    { id: 'n1', label: 'Apex Ventures', type: 'Investor', properties: { aum: '$2.1B', stage: 'Seed, Series A' } },
    { id: 'n2', label: 'ChainProtocol', type: 'Project', properties: { chain: 'Ethereum', token: 'CPROTO' } },
    { id: 'n3', label: 'Meridian Capital', type: 'Investor', properties: { aum: '$800M', stage: 'Series A, B' } },
    { id: 'n4', label: 'Series A Round', type: 'Round', properties: { amount: '$18M', date: '2024-Q3' } },
    { id: 'n5', label: 'DeFi Infrastructure', type: 'Narrative', properties: {} },
    { id: 'n6', label: 'Sara Chen', type: 'Person', properties: { role: 'Partner' } },
    { id: 'n7', label: 'Vertex Protocol', type: 'Project', properties: { chain: 'Arbitrum', token: 'VTEX' } },
    { id: 'n8', label: 'L2 Scaling', type: 'Narrative', properties: {} },
  ],
  edges: [
    { source: 'n1', target: 'n4', label: 'LED' },
    { source: 'n3', target: 'n4', label: 'INVESTED_IN' },
    { source: 'n4', target: 'n2', label: 'RAISED' },
    { source: 'n2', target: 'n5', label: 'CLASSIFIED_AS' },
    { source: 'n6', target: 'n1', label: 'PARTNERS_AT' },
    { source: 'n1', target: 'n7', label: 'INVESTED_IN' },
    { source: 'n7', target: 'n8', label: 'FOCUSES_ON' },
  ],
}

interface DemoGraphProps {
  className?: string
}

export default function DemoGraph({ className }: DemoGraphProps) {
  return (
    <div className={className}>
      <DemoGraphCanvas />
    </div>
  )
}
```

**Create `apps/web/components/landing/DemoGraphCanvas.tsx`** (actual Cytoscape render — loaded client-side only):
```typescript
'use client'

import CytoscapeComponent from 'react-cytoscapejs'
import Cytoscape from 'cytoscape'
import fcose from 'cytoscape-fcose'
import { cytoscapeStylesheet } from '@/components/graph/cytoscapeStyles'
import { DEMO_GRAPH_DATA } from './DemoGraph'

// CRITICAL: Register fcose at module level — registering inside component causes re-registration on every render
Cytoscape.use(fcose as Cytoscape.Ext)

export default function DemoGraphCanvas() {
  const elements = [
    ...DEMO_GRAPH_DATA.nodes.map(n => ({
      data: { id: n.id, label: n.label, type: n.type, ...n.properties },
    })),
    ...DEMO_GRAPH_DATA.edges.map(e => ({
      data: { source: e.source, target: e.target, label: e.label },
    })),
  ]

  return (
    <CytoscapeComponent
      elements={elements}
      stylesheet={cytoscapeStylesheet}
      layout={{
        name: 'fcose',
        animate: true,
        animationDuration: 800,
        animationEasing: 'ease-out',
        fit: true,
        padding: 30,
        nodeDimensionsIncludeLabels: true,
      } as Cytoscape.LayoutOptions}
      style={{ width: '100%', height: '100%' }}
      pixelRatio={1}
      userZoomingEnabled={true}
      userPanningEnabled={true}
      hideEdgesOnViewport={true}
    />
  )
}
```

**CRITICAL — DO NOT:**
- Call `Cytoscape.use(fcose)` inside the component body — causes re-registration error on re-renders
- Remove `ssr: false` from the dynamic import — Cytoscape crashes during SSR with "window is not defined"
- Create a new stylesheet — import `cytoscapeStylesheet` from `@/components/graph/cytoscapeStyles` for visual consistency between landing and app

The fcose `animate: true` with `animationDuration: 800` already satisfies the "animates in on load" locked decision — nodes fly into position from initial scattered positions. No additional staggered animation needed.
  </action>
  <verify>
    <automated>cd "/Users/uzi/Documents/Git Projects/instagraph-vc" && pnpm --filter web exec tsc --noEmit 2>&1 | head -20</automated>
    <manual>Confirm DemoGraph.tsx uses dynamic import with ssr:false. Confirm DemoGraphCanvas.tsx has Cytoscape.use(fcose) at module level (outside component function). Confirm DEMO_GRAPH_DATA has at least 6 nodes with correct types: Investor, Project, Round, Narrative, Person.</manual>
  </verify>
  <done>TypeScript compiles clean. DemoGraph.tsx exports DEMO_GRAPH_DATA and default DemoGraph with dynamic ssr:false wrapper. DemoGraphCanvas.tsx registers fcose at module level and renders CytoscapeComponent with cytoscapeStylesheet and fcose layout animate:true.</done>
</task>

<task type="auto">
  <name>Task 2: Landing nav and hero section</name>
  <files>
    apps/web/components/landing/LandingNav.tsx
    apps/web/components/landing/HeroSection.tsx
  </files>
  <action>
**Create `apps/web/components/landing/LandingNav.tsx`**:

Dark sticky nav with Instagraph logo left, auth-aware CTA right. For Phase 5, auth state is not yet wired from Clerk (Phase 3), so accept an optional `isAuthenticated` prop defaulting to false.

```typescript
'use client'

import Link from 'next/link'

interface LandingNavProps {
  isAuthenticated?: boolean
}

export default function LandingNav({ isAuthenticated = false }: LandingNavProps) {
  return (
    <nav className="sticky top-0 z-50 border-b border-gray-800 bg-gray-950/90 backdrop-blur-sm">
      <div className="mx-auto max-w-7xl px-6 h-16 flex items-center justify-between">
        {/* Logo */}
        <Link href="/" className="flex items-center gap-2 text-white">
          <span className="text-xl font-bold tracking-tight">Instagraph</span>
        </Link>

        {/* Auth-aware CTA */}
        {isAuthenticated ? (
          <Link
            href="/app"
            className="px-4 py-2 rounded-md bg-indigo-600 text-white text-sm font-medium hover:bg-indigo-700 transition-colors"
          >
            Go to app
          </Link>
        ) : (
          <Link
            href="/sign-in"
            className="px-4 py-2 rounded-md border border-gray-700 text-gray-300 text-sm font-medium hover:border-gray-500 hover:text-white transition-colors"
          >
            Sign In
          </Link>
        )}
      </div>
    </nav>
  )
}
```

**Create `apps/web/components/landing/HeroSection.tsx`**:

Split layout — input area left (text content + anonymous trial input box), demo graph right. Above the fold on desktop.

The input on the landing page is a simplified text input (not the full InputCard component with tabs) — it calls the `/api/generate` endpoint and shows the result inline. For Phase 5, show results below the hero section. The sign-up modal integration depends on Phase 3 (AUTH-02) being complete; per the research recommendation, if the modal is not yet available, show results inline with a "Sign up to save" prompt.

```typescript
'use client'

import { useState } from 'react'
import DemoGraph from './DemoGraph'

export default function HeroSection() {
  const [input, setInput] = useState('')
  const [isLoading, setIsLoading] = useState(false)
  const [result, setResult] = useState<{ nodes: number; edges: number } | null>(null)
  const [error, setError] = useState<string | null>(null)

  async function handleTry(e: React.FormEvent) {
    e.preventDefault()
    if (!input.trim() || isLoading) return
    setIsLoading(true)
    setError(null)
    setResult(null)

    try {
      const res = await fetch('/api/generate', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ input: input.trim() }),
      })
      if (!res.ok) {
        const data = await res.json().catch(() => ({}))
        setError(data.message ?? 'Something went wrong. Try again.')
        return
      }
      const data = await res.json()
      const nodeCount = data.graph?.nodes?.length ?? 0
      const edgeCount = data.graph?.edges?.length ?? 0
      if (nodeCount === 0) {
        setError('No VC relationships found. Try a more specific funding announcement.')
        return
      }
      setResult({ nodes: nodeCount, edges: edgeCount })
    } catch {
      setError('Request failed. Please try again.')
    } finally {
      setIsLoading(false)
    }
  }

  return (
    <section className="mx-auto max-w-7xl px-6 pt-20 pb-16 lg:pt-28">
      <div className="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
        {/* Left — headline + input */}
        <div className="space-y-8">
          <div className="space-y-4">
            <h1 className="text-4xl lg:text-5xl font-bold text-white leading-tight tracking-tight">
              Map the crypto VC network in seconds
            </h1>
            <p className="text-lg text-gray-400 max-w-lg">
              Paste any funding announcement or URL. AI extracts investors, projects, rounds, and relationships — instantly visualized as an interactive knowledge graph.
            </p>
          </div>

          {/* Anonymous trial input */}
          <form onSubmit={handleTry} className="space-y-3">
            <textarea
              value={input}
              onChange={e => setInput(e.target.value)}
              placeholder="Paste a funding announcement, article, or URL..."
              rows={4}
              className="w-full rounded-lg bg-gray-900 border border-gray-700 text-gray-100 placeholder-gray-500 px-4 py-3 text-sm resize-none focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-colors"
            />
            <button
              type="submit"
              disabled={!input.trim() || isLoading}
              className="w-full rounded-lg bg-indigo-600 text-white py-3 text-sm font-semibold hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
            >
              {isLoading ? 'Extracting...' : 'Try it free →'}
            </button>
          </form>

          {/* Inline result / error */}
          {result && (
            <div className="rounded-lg border border-emerald-800 bg-emerald-950/50 p-4">
              <p className="text-emerald-400 text-sm font-medium">
                Graph generated — {result.nodes} nodes, {result.edges} relationships
              </p>
              <p className="text-gray-400 text-xs mt-1">
                <a href="/sign-in" className="text-indigo-400 hover:text-indigo-300 underline">Sign up free</a> to save, search, and revisit your graphs.
              </p>
            </div>
          )}
          {error && (
            <p className="text-red-400 text-sm">{error}</p>
          )}
        </div>

        {/* Right — demo graph */}
        <div className="hidden lg:block h-[500px] rounded-xl overflow-hidden border border-gray-800 bg-gray-900">
          <DemoGraph className="w-full h-full" />
        </div>
      </div>
    </section>
  )
}
```

**Visual style constraints (from locked decisions):**
- Dark mode base: `bg-gray-950`, `bg-gray-900` for cards/containers
- Tone: premium data tool — clean typography, no decorative gradients, no glows
- Split hero layout: input card left, demo graph right above the fold (hidden on mobile: `hidden lg:block`)
- Headline direction: outcome-led — "Map the crypto VC network in seconds" (concrete, tool-forward)
  </action>
  <verify>
    <automated>cd "/Users/uzi/Documents/Git Projects/instagraph-vc" && pnpm --filter web exec tsc --noEmit 2>&1 | head -20</automated>
    <manual>Review LandingNav.tsx: sticky nav, Instagraph text logo on left, Sign In / Go to app conditional right. Review HeroSection.tsx: grid grid-cols-2 on lg, headline uses outcome-led copy, DemoGraph in right column with lg:hidden guard.</manual>
  </verify>
  <done>TypeScript compiles clean. LandingNav.tsx exports auth-aware sticky nav with logo left and conditional CTA right. HeroSection.tsx exports split grid layout with hero copy, textarea input, and DemoGraph in right column.</done>
</task>

</tasks>

<verification>
Run from repo root:
1. `pnpm --filter web exec tsc --noEmit` — TypeScript clean
2. Confirm `apps/web/components/landing/` directory contains: DemoGraph.tsx, DemoGraphCanvas.tsx, LandingNav.tsx, HeroSection.tsx
3. Confirm DemoGraph.tsx has `{ ssr: false }` in dynamic import
4. Confirm DemoGraphCanvas.tsx has `Cytoscape.use(fcose)` at module level (not inside component)
5. Confirm DEMO_GRAPH_DATA has nodes with type values matching: Investor, Project, Round, Narrative, Person
</verification>

<success_criteria>
- FE-04 (partial): DemoGraph canvas renders with fictional VC data using same cytoscapeStylesheet as app (visual consistency); fcose animates on mount with animationDuration: 800
- LandingNav.tsx: sticky, dark, Instagraph logo left, auth-aware CTA right (Sign In when unauthenticated, Go to app when authenticated)
- HeroSection.tsx: split lg:grid-cols-2 layout with outcome-led headline, anonymous trial textarea + submit, DemoGraph in right column
- No SSR crashes: DemoGraphCanvas is dynamic({ ssr: false }) wrapped
- TypeScript compiles clean
</success_criteria>

<output>
After completion, create `.planning/phases/05-landing-page-observability/05-03-SUMMARY.md`
</output>
